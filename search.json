[{"path":"https://igordot.github.io/clustermole/articles/clustermole-intro.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Introduction to clustermole","text":"clustermole R package designed simplify assignment cell type labels unknown cell populations, scRNA-seq clusters. provides methods query cell identity markers sourced variety databases. package includes three primary features: meta-database human mouse markers thousands cell types (clustermole_markers()) cell type prediction based set marker genes (clustermole_overlaps()) cell type prediction based table expression values (clustermole_enrichment())","code":""},{"path":"https://igordot.github.io/clustermole/articles/clustermole-intro.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Introduction to clustermole","text":"can install clustermole CRAN. Load clustermole.","code":"install.packages(\"clustermole\") library(clustermole)"},{"path":"https://igordot.github.io/clustermole/articles/clustermole-intro.html","id":"cell-type-markers","dir":"Articles","previous_headings":"","what":"Cell type markers","title":"Introduction to clustermole","text":"can use clustermole simple database get data frame cell type markers. row contains gene cell type associated . gene column gene symbol celltype_full column contains full cell type string, including species original database. Human mouse versions can retrieved. Many tools works gene sets require input list. convert markers data frame list, can use gene values celltype_full grouping variable.","code":"markers <- clustermole_markers(species = \"hs\") markers #> # A tibble: 422,292 × 8 #>    celltype_full         db    species organ celltype n_genes gene_origi…¹ gene  #>    <chr>                 <chr> <chr>   <chr> <chr>      <int> <chr>        <chr> #>  1 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 ACCSL        ACCSL #>  2 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 ACVR1B       ACVR… #>  3 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 ASF1B        ASF1B #>  4 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 BCL2L10      BCL2… #>  5 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 BLCAP        BLCAP #>  6 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 CASC3        CASC3 #>  7 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 CLEC10A      CLEC… #>  8 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 CNOT11       CNOT… #>  9 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 DCLK2        DCLK2 #> 10 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 DHCR7        DHCR7 #> # ℹ 422,282 more rows #> # ℹ abbreviated name: ¹​gene_original markers_list <- split(x = markers$gene, f = markers$celltype_full)"},{"path":"https://igordot.github.io/clustermole/articles/clustermole-intro.html","id":"cell-types-based-on-marker-genes","dir":"Articles","previous_headings":"","what":"Cell types based on marker genes","title":"Introduction to clustermole","text":"character vector genes, cluster markers, can compare known cell type markers see overlap known cell type markers (overrepresentation analysis).","code":"my_overlaps <- clustermole_overlaps(genes = my_genes_vec, species = \"hs\")"},{"path":"https://igordot.github.io/clustermole/articles/clustermole-intro.html","id":"cell-types-based-on-an-expression-matrix","dir":"Articles","previous_headings":"","what":"Cell types based on an expression matrix","title":"Introduction to clustermole","text":"expression values, average expression cluster, can perform cell type enrichment based full gene expression matrix (log-transformed CPM/TPM/FPKM values). matrix genes rows clusters/samples columns. underlying enrichment method can changed using method parameter.","code":"my_enrichment <- clustermole_enrichment(expr_mat = my_expr_mat, species = \"hs\")"},{"path":"https://igordot.github.io/clustermole/articles/db.html","id":"number-of-cell-types","dir":"Articles","previous_headings":"","what":"Number of cell types","title":"Database details","text":"Check total number available cell types.","code":"length(unique(markers$celltype_full)) #> [1] 3039"},{"path":"https://igordot.github.io/clustermole/articles/db.html","id":"number-of-cell-types-by-source-database","dir":"Articles","previous_headings":"","what":"Number of cell types by source database","title":"Database details","text":"Check source databases number cell types .","code":"distinct(markers, celltype_full, db) |> count(db) #> # A tibble: 7 × 2 #>   db             n #>   <chr>      <int> #> 1 ARCHS4       108 #> 2 CellMarker   692 #> 3 MSigDB       295 #> 4 PanglaoDB    322 #> 5 SaVanT       619 #> 6 TISSUES      537 #> 7 xCell        466"},{"path":"https://igordot.github.io/clustermole/articles/db.html","id":"number-of-cell-types-by-species","dir":"Articles","previous_headings":"","what":"Number of cell types by species","title":"Database details","text":"Check number cell types per species (available cell types).","code":"distinct(markers, celltype_full, species) |> count(species) #> # A tibble: 3 × 2 #>   species     n #>   <chr>   <int> #> 1 \"\"        323 #> 2 \"Human\"  1866 #> 3 \"Mouse\"   850"},{"path":"https://igordot.github.io/clustermole/articles/db.html","id":"number-of-cell-types-by-organ","dir":"Articles","previous_headings":"","what":"Number of cell types by organ","title":"Database details","text":"Check number available cell types per organ (available cell types).","code":"distinct(markers, celltype_full, organ) |> count(organ, sort = TRUE) #> # A tibble: 93 × 2 #>    organ                  n #>    <chr>              <int> #>  1 \"\"                  2160 #>  2 \"Brain\"              122 #>  3 \"Immune system\"       50 #>  4 \"Lung\"                47 #>  5 \"Kidney\"              43 #>  6 \"Bone marrow\"         42 #>  7 \"Liver\"               38 #>  8 \"Blood\"               33 #>  9 \"Embryo\"              30 #> 10 \"Peripheral blood\"    29 #> # ℹ 83 more rows"},{"path":"https://igordot.github.io/clustermole/articles/db.html","id":"package-version","dir":"Articles","previous_headings":"","what":"Package version","title":"Database details","text":"Check package version since database contents may change.","code":"packageVersion(\"clustermole\") #> [1] '1.1.1.9000'"},{"path":"https://igordot.github.io/clustermole/articles/example-bm-seurat.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Cell type annotation example","text":"Assignment cell type labels scRNA-seq clusters particularly difficult unexpected poorly described populations present. fully automated algorithms cell type annotation, sometimes -depth analysis helpful understanding captured cells. example exploratory cell type analysis using clustermole, starting Seurat object. dataset used example contains hematopoietic stromal bone marrow populations (Baccin et al.). experiment selected includes well-known well rare cell types.","code":""},{"path":"https://igordot.github.io/clustermole/articles/example-bm-seurat.html","id":"load-data","dir":"Articles","previous_headings":"","what":"Load data","title":"Cell type annotation example","text":"Load relevant packages. Download dataset, stored Seurat object. subset tutorial reduce size speed processing. Check experiment labels tSNE visualization, shown original publication (original figure).  Check cell type labels tSNE visualization.  Set Seurat object cell identities predefined cell type labels next steps.","code":"library(Seurat) library(dplyr) library(ggplot2) library(ggsci) library(clustermole) so <- readRDS(url(\"https://osf.io/cvnqb/download\")) so #> An object of class Seurat  #> 16701 features across 2821 samples within 1 assay  #> Active assay: RNA (16701 features, 2872 variable features) #>  2 layers present: counts, data #>  3 dimensional reductions calculated: pca, tsne, umap DimPlot(so, reduction = \"tsne\", group.by = \"experiment\", shuffle = TRUE) +   theme(aspect.ratio = 1, legend.text = element_text(size = rel(0.7))) +   scale_color_nejm() DimPlot(so, reduction = \"tsne\", group.by = \"celltype\", shuffle = TRUE) +   theme(aspect.ratio = 1, legend.text = element_text(size = rel(0.8))) +   scale_color_igv() Idents(so) <- \"celltype\" levels(Idents(so)) #>  [1] \"Adipo-CAR\"        \"Arteriolar-ECs\"   \"Arteriolar-fibro\" \"B-cell\"           #>  [5] \"Chondrocytes\"     \"Dendritic-cells\"  \"Endosteal-fibro\"  \"Eo-Baso-prog\"     #>  [9] \"Ery-Mk-prog\"      \"Ery-prog\"         \"Erythroblasts\"    \"Fibro-Chondro-p\"  #> [13] \"Gran-Mono-prog\"   \"large-pre-B\"      \"LMPPs\"            \"Mk-prog\"          #> [17] \"Mono-prog\"        \"Monocytes\"        \"Myofibroblasts\"   \"Neutro-prog\"      #> [21] \"Neutrophils\"      \"Ng2-MSCs\"         \"NK-cells\"         \"Osteo-CAR\"        #> [25] \"Osteoblasts\"      \"pro-B\"            \"Schwann-cells\"    \"Sinusoidal-ECs\"   #> [29] \"small-pre-B\"      \"Smooth-muscle\"    \"Stromal-fibro\"    \"T-cells\""},{"path":"https://igordot.github.io/clustermole/articles/example-bm-seurat.html","id":"marker-gene-overlaps","dir":"Articles","previous_headings":"","what":"Marker gene overlaps","title":"Cell type annotation example","text":"One type analysis facilitated clustermole based comparison marker genes. can start B-cells, well-defined population used many studies. Find markers B-cell cluster. gives us data frame hundreds genes. can subset just best 25 markers. Check overlap B-cell markers clustermole cell type signatures. Check top scoring cell types corresponding B-cell cluster markers. expected well-defined population, top results various B-cell populations. can repeat process populations obscure. Find markers Adipo-CAR cluster. Cxcl12-abundant reticular (CAR) cells expressing adipocyte-lineage genes. Check overlap Adipo-CAR markers cell type signatures. Check top scoring cell types Adipo-CAR cluster. top results diverse B-cells, related populations among top candidates. Find markers Osteoblasts cluster. Check overlap Osteoblasts markers cell type signatures. Check top scoring cell types Osteoblasts cluster. top results diverse B-cells, appropriate populations listed.","code":"b_markers_df <- FindMarkers(so, ident.1 = \"B-cell\", min.pct = 0.2, only.pos = TRUE, verbose = FALSE) #> For a (much!) faster implementation of the Wilcoxon Rank Sum Test, #> (default method for FindMarkers) please install the presto package #> -------------------------------------------- #> install.packages('devtools') #> devtools::install_github('immunogenomics/presto') #> -------------------------------------------- #> After installation of presto, Seurat will automatically use the more  #> efficient implementation (no further action necessary). #> This message will be shown once per session nrow(b_markers_df) #> [1] 1631 b_markers <- head(rownames(b_markers_df), 25) b_markers #>  [1] \"Ms4a1\"         \"Fcmr\"          \"Cd74\"          \"Ly6d\"          #>  [5] \"Gm43603\"       \"Bank1\"         \"2010309G21Rik\" \"Fcer2a\"        #>  [9] \"H2-DMb2\"       \"H2-Eb1\"        \"Cd79a\"         \"H2-Aa\"         #> [13] \"Tnfrsf13c\"     \"Ltb\"           \"Cd79b\"         \"Ccr7\"          #> [17] \"Fcrl1\"         \"Spib\"          \"Siglecg\"       \"Cd83\"          #> [21] \"Fcrla\"         \"Srpk3\"         \"Cd22\"          \"Cxcr5\"         #> [25] \"H2-Ab1\" overlaps_tbl <- clustermole_overlaps(genes = b_markers, species = \"mm\") head(overlaps_tbl, 15) #> # A tibble: 15 × 9 #>    celltype_full                                                    db         #>    <chr>                                                            <chr>      #>  1 follicular_B-cells | SaVanT                                      SaVanT     #>  2 B cell (Renal Cell Carcinoma) | Kidney | Human | CellMarker      CellMarker #>  3 DURANTE_ADULT_OLFACTORY_NEUROEPITHELIUM_B_CELLS | Human | MSigDB MSigDB     #>  4 IMGN_B_Fo_MLN | Mouse | SaVanT                                   SaVanT     #>  5 AIZARANI_LIVER_C34_MHC_II_POS_B_CELLS | Human | MSigDB           MSigDB     #>  6 B cells | Immune system | Human | PanglaoDB                      PanglaoDB  #>  7 B cells naive | Immune system | Human | PanglaoDB                PanglaoDB  #>  8 IMGN_B_Fo_LN | Mouse | SaVanT                                    SaVanT     #>  9 IMGN_B_FrE_BM | Mouse | SaVanT                                   SaVanT     #> 10 IMGN_B_T3_Sp | Mouse | SaVanT                                    SaVanT     #> 11 spleen | SaVanT                                                  SaVanT     #> 12 B cell | Kidney | Human | CellMarker                             CellMarker #> 13 FAN_EMBRYONIC_CTX_BRAIN_B_CELL | Human | MSigDB                  MSigDB     #> 14 IMGN_B1a_Sp | Mouse | SaVanT                                     SaVanT     #> 15 IMGN_B_Fo_PC | Mouse | SaVanT                                    SaVanT     #> # ℹ 7 more variables: species <chr>, organ <chr>, celltype <chr>, #> #   n_genes <int>, overlap <dbl>, p_value <dbl>, fdr <dbl> acar_markers_df <- FindMarkers(so, ident.1 = \"Adipo-CAR\", min.pct = 0.2, only.pos = TRUE, verbose = FALSE) acar_markers <- head(rownames(acar_markers_df), 25) acar_markers #>  [1] \"Adipoq\"        \"Kng1\"          \"Kng2\"          \"Esm1\"          #>  [5] \"Cxcl12\"        \"Lpl\"           \"Gdpd2\"         \"Agt\"           #>  [9] \"Dpep1\"         \"Lepr\"          \"Fst\"           \"Chrdl1\"        #> [13] \"Pdzrn4\"        \"Kitl\"          \"Cxcl14\"        \"Ccl19\"         #> [17] \"Ptx3\"          \"Ackr4\"         \"1500009L16Rik\" \"Gas6\"          #> [21] \"Serpina12\"     \"C4b\"           \"Gm4951\"        \"Fbln5\"         #> [25] \"Wisp2\" overlaps_tbl <- clustermole_overlaps(genes = acar_markers, species = \"mm\") head(overlaps_tbl, 15) #> # A tibble: 15 × 9 #>    celltype_full                                                  db         #>    <chr>                                                          <chr>      #>  1 IMGN_FRC_MLN | Mouse | SaVanT                                  SaVanT     #>  2 OMENTUM | ARCHS4                                               ARCHS4     #>  3 HAY_BONE_MARROW_STROMAL | Human | MSigDB                       MSigDB     #>  4 Schwalie et al.Nature.P3 | Adipose tissue | Mouse | CellMarker CellMarker #>  5 LUNG (BULK TISSUE) | ARCHS4                                    ARCHS4     #>  6 HPCA_Adipocytes | Human | SaVanT                               SaVanT     #>  7 IMGN_FRC_SLN | Mouse | SaVanT                                  SaVanT     #>  8 HBA_Adipocyte | Human | SaVanT                                 SaVanT     #>  9 Schwalie et al.Nature.G3 | Adipose tissue | Mouse | CellMarker CellMarker #> 10 GASTRIC TISSUE (BULK) | ARCHS4                                 ARCHS4     #> 11 SUBCUTANEOUS ADIPOSE TISSUE | ARCHS4                           ARCHS4     #> 12 ADIPOSE (BULK TISSUE) | ARCHS4                                 ARCHS4     #> 13 ASTROCYTE | ARCHS4                                             ARCHS4     #> 14 BREAST (BULK TISSUE) | ARCHS4                                  ARCHS4     #> 15 Medullary cell | Kidney | Mouse | CellMarker                   CellMarker #> # ℹ 7 more variables: species <chr>, organ <chr>, celltype <chr>, #> #   n_genes <int>, overlap <dbl>, p_value <dbl>, fdr <dbl> o_markers_df <- FindMarkers(so, ident.1 = \"Osteoblasts\", min.pct = 0.2, only.pos = TRUE, verbose = FALSE) o_markers <- head(rownames(o_markers_df), 25) o_markers #>  [1] \"Cpz\"           \"Smpd3\"         \"Col22a1\"       \"Ifitm5\"        #>  [5] \"Mlip\"          \"Bglap\"         \"Lipc\"          \"Cgref1\"        #>  [9] \"Col13a1\"       \"Entpd3\"        \"Fabp3\"         \"Bglap2\"        #> [13] \"Cthrc1\"        \"Bglap3\"        \"Col11a2\"       \"Rerg\"          #> [17] \"Cdo1\"          \"Car3\"          \"Slc36a2\"       \"RP23-457J22.1\" #> [21] \"Col24a1\"       \"Col11a1\"       \"Bmp3\"          \"Cadm1\"         #> [25] \"Satb2\" overlaps_tbl <- clustermole_overlaps(genes = o_markers, species = \"mm\") head(overlaps_tbl, 15) #> # A tibble: 15 × 9 #>    celltype_full                                                   db         #>    <chr>                                                           <chr>      #>  1 DCLK1+ progenitor cell | Large intestine | Human | CellMarker   CellMarker #>  2 GAO_LARGE_INTESTINE_24W_C1_DCLK1POS_PROGENITOR | Human | MSigDB MSigDB     #>  3 VALVE | ARCHS4                                                  ARCHS4     #>  4 OSTEOBLAST | ARCHS4                                             ARCHS4     #>  5 Cartilage | Human | TISSUES                                     TISSUES    #>  6 GASTRIC TISSUE (BULK) | ARCHS4                                  ARCHS4     #>  7 HAY_BONE_MARROW_PLASMA_CELL | Human | MSigDB                    MSigDB     #>  8 Chondrogenic cell | Adipose tissue | Mouse | CellMarker         CellMarker #>  9 MANNO_MIDBRAIN_NEUROTYPES_HSERT | Human | MSigDB                MSigDB     #> 10 Intestine | Mouse | TISSUES                                     TISSUES    #> 11 BREAST (BULK TISSUE) | ARCHS4                                   ARCHS4     #> 12 RENAL CORTEX | ARCHS4                                           ARCHS4     #> 13 Cancer stem cell (Glioblastoma) | Brain | Human | CellMarker    CellMarker #> 14 LUNG (BULK TISSUE) | ARCHS4                                     ARCHS4     #> 15 HAIR FOLLICLE | ARCHS4                                          ARCHS4     #> # ℹ 7 more variables: species <chr>, organ <chr>, celltype <chr>, #> #   n_genes <int>, overlap <dbl>, p_value <dbl>, fdr <dbl>"},{"path":"https://igordot.github.io/clustermole/articles/example-bm-seurat.html","id":"enrichment-of-markers","dir":"Articles","previous_headings":"","what":"Enrichment of markers","title":"Cell type annotation example","text":"Rather comparing marker genes, ’s also possible run enrichment cell type signatures across genes. avoids define optimal set markers. Calculate average expression levels cell type. Convert regular matrix log-transform. Preview expression matrix. Run enrichment cell type signatures across clusters. Check enriched cell types B-cell cluster. previous analysis, top results various B-cell populations. Check enriched cell types Adipo-CAR cluster. Check enriched cell types Osteoblasts cluster.","code":"avg_exp_mat <- AverageExpression(so) #> As of Seurat v5, we recommend using AggregateExpression to perform pseudo-bulk analysis. #> This message is displayed once per session. avg_exp_mat <- as.matrix(avg_exp_mat$RNA) avg_exp_mat <- log1p(avg_exp_mat) avg_exp_mat[1:5, 1:5] #>         Adipo-CAR Arteriolar-ECs Arteriolar-fibro    B-cell Chondrocytes #> Sox17   0.0000000      2.5800606        0.0000000 0.0000000   0.00000000 #> Mrpl15  0.4315376      0.5284282        0.3304569 0.8481054   0.07307574 #> Lypla1  0.1990537      0.4477973        0.2448583 0.6352917   0.09397463 #> Gm37988 0.0000000      0.0000000        0.0000000 0.0000000   0.00000000 #> Tcea1   0.5620502      0.7077588        0.6135480 0.7798060   0.52126901 enrich_tbl <- clustermole_enrichment(expr_mat = avg_exp_mat, species = \"mm\") enrich_tbl %>%   filter(cluster == \"B-cell\") %>%   head(15) #> # A tibble: 15 × 9 #>    cluster celltype_full                                                    #>    <chr>   <chr>                                                            #>  1 B-cell  naive B-cells_BLUEPRINT_1 | Human | xCell                        #>  2 B-cell  naive B-cells_BLUEPRINT_3 | Human | xCell                        #>  3 B-cell  Follicular B cell | Lymphoid tissue | Mouse | CellMarker         #>  4 B-cell  B-cells_HPCA_3 | Human | xCell                                   #>  5 B-cell  Memory B cell | Lymphoid tissue | Mouse | CellMarker             #>  6 B-cell  Class-switched memory B-cells_NOVERSHTERN_1 | Human | xCell      #>  7 B-cell  Class-switched memory B-cells_NOVERSHTERN_2 | Human | xCell      #>  8 B-cell  Class-switched memory B-cells_NOVERSHTERN_3 | Human | xCell      #>  9 B-cell  DURANTE_ADULT_OLFACTORY_NEUROEPITHELIUM_B_CELLS | Human | MSigDB #> 10 B-cell  Memory B-cells_HPCA_2 | Human | xCell                            #> 11 B-cell  M1 macrophage | Lung | Mouse | CellMarker                        #> 12 B-cell  Leukocyte | Blood | Human | CellMarker                           #> 13 B-cell  IMGN_B_T2_Sp | Mouse | SaVanT                                    #> 14 B-cell  follicular_B-cells | SaVanT                                      #> 15 B-cell  Leukocyte | Human | CellMarker                                   #> # ℹ 7 more variables: score <dbl>, score_rank <int>, db <chr>, species <chr>, #> #   organ <chr>, celltype <chr>, n_genes <int> enrich_tbl %>%   filter(cluster == \"Adipo-CAR\") %>%   head(15) #> # A tibble: 15 × 9 #>    cluster   celltype_full                                                   #>    <chr>     <chr>                                                           #>  1 Adipo-CAR Colorectal stem cell | Colorectum | Human | CellMarker          #>  2 Adipo-CAR Fibroblast | Mouse | CellMarker                                 #>  3 Adipo-CAR Cardiac progenitor cell | Heart | Human | CellMarker            #>  4 Adipo-CAR Rheaume et al.Nat Commun.16 | Retina | Mouse | CellMarker       #>  5 Adipo-CAR Erythroid cell | Human | TISSUES                                #>  6 Adipo-CAR IMGN_Fi_MTS15+_Th | Mouse | SaVanT                              #>  7 Adipo-CAR IMGN_FRC_MLN | Mouse | SaVanT                                   #>  8 Adipo-CAR Intestinal stem cell | Intestine | Mouse | CellMarker           #>  9 Adipo-CAR IMGN_FRC_SLN | Mouse | SaVanT                                   #> 10 Adipo-CAR Interneuron-selective cell | Brain | Mouse | CellMarker         #> 11 Adipo-CAR Smooth muscle cell | Brain | Mouse | CellMarker                 #> 12 Adipo-CAR Glutaminergic neurons | Brain | Human | PanglaoDB               #> 13 Adipo-CAR Glutaminergic neurons | Brain | Mouse | PanglaoDB               #> 14 Adipo-CAR CUI_DEVELOPING_HEART_LEFT_ATRIAL_CARDIOMYOCYTE | Human | MSigDB #> 15 Adipo-CAR HPCA_Fibroblasts | Human | SaVanT                               #> # ℹ 7 more variables: score <dbl>, score_rank <int>, db <chr>, species <chr>, #> #   organ <chr>, celltype <chr>, n_genes <int> enrich_tbl %>%   filter(cluster == \"Osteoblasts\") %>%   head(15) #> # A tibble: 15 × 9 #>    cluster     celltype_full                                                 #>    <chr>       <chr>                                                         #>  1 Osteoblasts Ito cell (hepatic stellate cell) | Liver | Human | CellMarker #>  2 Osteoblasts Intestinal stem cell | Intestine | Mouse | CellMarker         #>  3 Osteoblasts Rheaume et al.Nat Commun.37 | Retina | Mouse | CellMarker     #>  4 Osteoblasts Osteocyte | Bone | Human | CellMarker                         #>  5 Osteoblasts Cornea | Human | TISSUES                                      #>  6 Osteoblasts Keratinocytes_ENCODE_1 | Human | xCell                        #>  7 Osteoblasts Radial glial cell | Human | CellMarker                        #>  8 Osteoblasts Rheaume et al.Nat Commun.34 | Retina | Mouse | CellMarker     #>  9 Osteoblasts Sebocytes_FANTOM_2 | Human | xCell                            #> 10 Osteoblasts Melanocytes_ENCODE_2 | Human | xCell                          #> 11 Osteoblasts Rheaume et al.Nat Commun.4 | Retina | Mouse | CellMarker      #> 12 Osteoblasts Follicular cells | Thyroid | Human | PanglaoDB                #> 13 Osteoblasts Follicular cells | Thyroid | Mouse | PanglaoDB                #> 14 Osteoblasts osteoblast_day14 | SaVanT                                     #> 15 Osteoblasts Lee et al.Cell.E | Lung | Mouse | CellMarker                  #> # ℹ 7 more variables: score <dbl>, score_rank <int>, db <chr>, species <chr>, #> #   organ <chr>, celltype <chr>, n_genes <int>"},{"path":"https://igordot.github.io/clustermole/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Igor Dolgalev. Author, maintainer.","code":""},{"path":"https://igordot.github.io/clustermole/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Dolgalev (2024). clustermole: Unbiased Single-Cell Transcriptomic Data Cell Type Identification. R package version 1.1.1.9000, https://igordot.github.io/clustermole/.","code":"@Manual{,   title = {clustermole: Unbiased Single-Cell Transcriptomic Data Cell Type Identification},   author = {Igor Dolgalev},   year = {2024},   note = {R package version 1.1.1.9000},   url = {https://igordot.github.io/clustermole/}, }"},{"path":"https://igordot.github.io/clustermole/reference/clustermole_enrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell types based on the expression of all genes — clustermole_enrichment","title":"Cell types based on the expression of all genes — clustermole_enrichment","text":"Perform enrichment cell type signatures based full gene expression matrix.","code":""},{"path":"https://igordot.github.io/clustermole/reference/clustermole_enrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell types based on the expression of all genes — clustermole_enrichment","text":"","code":"clustermole_enrichment(expr_mat, species, method = \"gsva\")"},{"path":"https://igordot.github.io/clustermole/reference/clustermole_enrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell types based on the expression of all genes — clustermole_enrichment","text":"expr_mat Expression matrix (logCPMs, logFPKMs, logTPMs) genes rows clusters/populations/samples columns. species Species: hs human mm mouse. method Enrichment method: ssgsea, gsva, singscore, . method use estimation gene set enrichment scores. options ssGSEA (Barbie et al, 2009), GSVA (Hänzelmann et al, 2013), singscore (Foroutan et al, 2018), combination three methods.","code":""},{"path":"https://igordot.github.io/clustermole/reference/clustermole_enrichment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell types based on the expression of all genes — clustermole_enrichment","text":"data frame enrichment results.","code":""},{"path":"https://igordot.github.io/clustermole/reference/clustermole_enrichment.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cell types based on the expression of all genes — clustermole_enrichment","text":"Barbie, D., Tamayo, P., Boehm, J. et al. Systematic RNA interference reveals oncogenic KRAS-driven cancers require TBK1. Nature 462, 108–112 (2009). doi:10.1038/nature08460 Hänzelmann, S., Castelo, R. & Guinney, J. GSVA: Gene set variation analysis microarray RNA-Seq data. BMC Bioinformatics 14, 7 (2013). doi:10.1186/1471-2105-14-7 Foroutan, M., Bhuva, D.D., Lyu, R. et al. Single sample scoring molecular phenotypes. BMC Bioinformatics 19, 404 (2018). doi:10.1186/s12859-018-2435-4","code":""},{"path":"https://igordot.github.io/clustermole/reference/clustermole_enrichment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cell types based on the expression of all genes — clustermole_enrichment","text":"","code":"# my_enrichment <- clustermole_enrichment(expr_mat = my_expr_mat, species = \"hs\")"},{"path":"https://igordot.github.io/clustermole/reference/clustermole_markers.html","id":null,"dir":"Reference","previous_headings":"","what":"Available cell type markers — clustermole_markers","title":"Available cell type markers — clustermole_markers","text":"Retrieve full list cell type markers clustermole database.","code":""},{"path":"https://igordot.github.io/clustermole/reference/clustermole_markers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Available cell type markers — clustermole_markers","text":"","code":"clustermole_markers(species = c(\"hs\", \"mm\"))"},{"path":"https://igordot.github.io/clustermole/reference/clustermole_markers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Available cell type markers — clustermole_markers","text":"species Species: hs human mm mouse.","code":""},{"path":"https://igordot.github.io/clustermole/reference/clustermole_markers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Available cell type markers — clustermole_markers","text":"data frame cell type markers (one gene per row).","code":""},{"path":"https://igordot.github.io/clustermole/reference/clustermole_markers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Available cell type markers — clustermole_markers","text":"","code":"markers <- clustermole_markers() head(markers) #> # A tibble: 6 × 8 #>   celltype_full         db    species organ celltype n_genes gene_original gene  #>   <chr>                 <chr> <chr>   <chr> <chr>      <int> <chr>         <chr> #> 1 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 ACCSL         ACCSL #> 2 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 ACVR1B        ACVR… #> 3 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 ASF1B         ASF1B #> 4 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 BCL2L10       BCL2… #> 5 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 BLCAP         BLCAP #> 6 1-cell stage cell (B… Cell… Human   Embr… 1-cell …      32 CASC3         CASC3"},{"path":"https://igordot.github.io/clustermole/reference/clustermole_overlaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell types based on overlap of marker genes — clustermole_overlaps","title":"Cell types based on overlap of marker genes — clustermole_overlaps","text":"Perform overrepresentation analysis set genes compared cell type signatures.","code":""},{"path":"https://igordot.github.io/clustermole/reference/clustermole_overlaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell types based on overlap of marker genes — clustermole_overlaps","text":"","code":"clustermole_overlaps(genes, species)"},{"path":"https://igordot.github.io/clustermole/reference/clustermole_overlaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell types based on overlap of marker genes — clustermole_overlaps","text":"genes vector genes. species Species: hs human mm mouse.","code":""},{"path":"https://igordot.github.io/clustermole/reference/clustermole_overlaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell types based on overlap of marker genes — clustermole_overlaps","text":"data frame enrichment results hypergeometric test p-values.","code":""},{"path":"https://igordot.github.io/clustermole/reference/clustermole_overlaps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cell types based on overlap of marker genes — clustermole_overlaps","text":"","code":"my_genes <- c(\"CD2\", \"CD3D\", \"CD3E\", \"CD3G\", \"TRAC\", \"TRBC2\", \"LTB\") my_overlaps <- clustermole_overlaps(genes = my_genes, species = \"hs\") head(my_overlaps) #> # A tibble: 6 × 9 #>   celltype_full   db    species organ celltype n_genes overlap  p_value      fdr #>   <chr>           <chr> <chr>   <chr> <chr>      <int>   <dbl>    <dbl>    <dbl> #> 1 DURANTE_ADULT_… MSig… Human   \"\"    DURANTE…      22       6 4.36e-18 1.33e-14 #> 2 T memory cells… Pang… Human   \"Imm… T memor…      38       6 1.61e-16 2.45e-13 #> 3 T memory cells… Pang… Mouse   \"Imm… T memor…      40       6 3.57e-16 3.61e-13 #> 4 T cells | Immu… Pang… Human   \"Imm… T cells       70       6 8.38e-15 5.55e-12 #> 5 T cells | Immu… Pang… Mouse   \"Imm… T cells       69       6 9.14e-15 5.55e-12 #> 6 AIZARANI_LIVER… MSig… Human   \"\"    AIZARAN…     120       6 2.61e-13 1.32e-10"},{"path":"https://igordot.github.io/clustermole/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://igordot.github.io/clustermole/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://igordot.github.io/clustermole/reference/read_gmt.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a GMT file into a data frame — read_gmt","title":"Read a GMT file into a data frame — read_gmt","text":"Read GMT file data frame","code":""},{"path":"https://igordot.github.io/clustermole/reference/read_gmt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a GMT file into a data frame — read_gmt","text":"","code":"read_gmt(file, geneset_label = \"celltype\", gene_label = \"gene\")"},{"path":"https://igordot.github.io/clustermole/reference/read_gmt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a GMT file into a data frame — read_gmt","text":"file connection object character string (can URL). geneset_label Column name gene sets (first column GMT file) output data frame. gene_label Column name genes (variable columns GMT file) output data frame.","code":""},{"path":"https://igordot.github.io/clustermole/reference/read_gmt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a GMT file into a data frame — read_gmt","text":"data frame gene sets first column genes second column (one gene per row).","code":""},{"path":"https://igordot.github.io/clustermole/reference/read_gmt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read a GMT file into a data frame — read_gmt","text":"","code":"gmt <- \"http://software.broadinstitute.org/gsea/msigdb/supplemental/scsig.all.v1.0.symbols.gmt\" gmt_tbl <- read_gmt(gmt) head(gmt_tbl) #> # A tibble: 6 × 2 #>   celltype                                              gene     #>   <chr>                                                 <chr>    #> 1 Zheng_Cord_Blood_C1_Putative_Megakaryocyte_Progenitor ABCC3    #> 2 Zheng_Cord_Blood_C1_Putative_Megakaryocyte_Progenitor ABCC4    #> 3 Zheng_Cord_Blood_C1_Putative_Megakaryocyte_Progenitor ACTN1    #> 4 Zheng_Cord_Blood_C1_Putative_Megakaryocyte_Progenitor ARHGAP18 #> 5 Zheng_Cord_Blood_C1_Putative_Megakaryocyte_Progenitor ARHGAP6  #> 6 Zheng_Cord_Blood_C1_Putative_Megakaryocyte_Progenitor BANK1"},{"path":"https://igordot.github.io/clustermole/news/index.html","id":"clustermole-111","dir":"Changelog","previous_headings":"","what":"clustermole 1.1.1","title":"clustermole 1.1.1","text":"CRAN release: 2024-01-08 Updated internal GSVA tidyselect function calls.","code":""},{"path":"https://igordot.github.io/clustermole/news/index.html","id":"clustermole-110","dir":"Changelog","previous_headings":"","what":"clustermole 1.1.0","title":"clustermole 1.1.0","text":"CRAN release: 2021-01-26 Added singscore enrichment method. Added combined enrichment method. Updated cell type markers.","code":""},{"path":"https://igordot.github.io/clustermole/news/index.html","id":"clustermole-101","dir":"Changelog","previous_headings":"","what":"clustermole 1.0.1","title":"clustermole 1.0.1","text":"CRAN release: 2020-01-27 Updated documentation.","code":""},{"path":"https://igordot.github.io/clustermole/news/index.html","id":"clustermole-100","dir":"Changelog","previous_headings":"","what":"clustermole 1.0.0","title":"clustermole 1.0.0","text":"CRAN release: 2020-01-20 Initial CRAN submission.","code":""}]
